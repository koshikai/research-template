# marimo 概要と導入ガイド

marimoは、次世代のリアクティブなPythonノートブックです。従来のJupyter Notebookの課題（実行順序による不整合、JSON形式によるバージョン管理の難しさなど）を解消することを目的として設計されています。

## 特徴

- **リアクティブ実行**: セル間の依存関係を自動的に追跡し、変数が変更されると関連するセルが自動的に再実行されます。
- **純粋なPythonファイル**: ノートブックは標準的な `.py` ファイルとして保存されます。これにより、Gitなどのバージョン管理ツールとの相性が非常に良く、通常のスクリプトとしても実行可能です。
- **UIコンポーネント**: スライダー、ボタン、ドロップダウンなどの対話型UIコンポーネントが標準で用意されており、ダッシュボード作成が容易です。
- **uv 連携**: 超高速パッケージマネージャー `uv` と密接に連携し、ノートブックごとに隔離された環境（サンドボックス）を構築できます。
- **型安全性とデバッグ**: 開発者フレンドリーなエディタ機能（オートコンプリート、ツールチップ、デバッグパネル）を備えています。

## 主要なCLIコマンド

| コマンド | 説明 |
|---------|------|
| `marimo edit [file]` | ノートブックのエディタを起動します。 |
| `marimo run [file]` | ノートブックを読み取り専用の対話型アプリとして提供します。 |
| `marimo export html [file]` | ノートブックを静的なHTMLとして書き出します。 |
| `marimo convert [ipynb]` | Jupyter Notebookをmarimo形式（.py）に変換します。 |

## uv との連携

`uv` を使用することで、依存関係の管理が非常にスムーズになります。

```bash
# プロジェクトへの追加
uv add marimo

# エディタの起動 (現在の環境を使用)
uv run marimo edit notebook.py

# サンドボックス環境での起動 (ノートブック内の依存定義を使用)
uv run marimo edit --sandbox notebook.py
```

## Web UI の実行チェック

`marimo` ノートブックをWeb UIとして実行し、ブラウザ側のエラーまで確認したい場合は
スモークテストを使います。

```bash
# 依存 (初回のみ)
uv add --dev playwright
uv run playwright install chromium

# UIチェック
uv run --group dev poe ui-check -- --notebook notebooks/analysis_sample.py
```

## ベストプラクティス

1. **グローバル変数の抑制**: 意図しない再実行を防ぐため、変数は関数内に閉じ込めるか、セルのローカルにするためにアンダースコア（`_tmp`など）を付けます。
2. **関数の活用**: ロジックを関数化することで、marimoのリアクティブ実行の恩恵を最大限に受けられます。
3. **副作用の回避**: オブジェクトの破壊的な変更（`list.append`など）は避け、新しいオブジェクトを生成するようにします。

## 当プロジェクトでの活用

当プロジェクトは `uv` をベースとした **Astral Stack** を採用しているため、marimoとの親和性が非常に高いです。
`notebooks/` ディレクトリ配下で実験の可視化やプロトタイピングに使用することを推奨します。
